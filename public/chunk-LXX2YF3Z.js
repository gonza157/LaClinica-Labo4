import{a as z}from"./chunk-E4UFZBRC.js";import"./chunk-Q4YU3M55.js";import{a as Q,g as W}from"./chunk-FXXNP7EN.js";import{a as gt}from"./chunk-4WUXS4KB.js";import{e as it,f as at}from"./chunk-UQXX2G4H.js";import{a as ot,b as rt,c as ct,d as st,e as lt,f as dt,g as pt,h as mt}from"./chunk-KYJNGL4I.js";import{B as X,D as I,E as k,Y as nt}from"./chunk-X7NSQYYE.js";import{Ab as $,Eb as w,Gb as M,Hb as d,Ic as q,Jc as G,Kc as S,Nc as J,Oa as U,Oc as K,Pc as E,Qa as r,Rb as L,Tb as N,Va as R,Vb as o,Wb as f,Xb as y,Yb as V,Zd as Z,_ as O,ab as v,ce as T,de as tt,ea as C,ec as g,ee as et,fa as P,fc as u,fe as A,gb as m,gc as B,hc as Y,he as H,ke as D,xb as s,yb as a,zb as e}from"./chunk-7XCQR3O2.js";import{a as j,h as x}from"./chunk-FJYW2LMB.js";function Pt(i,n){if(i&1&&(a(0,"p"),o(1),e()),i&2){let t=d();r(),f(t.data.resena)}}function Mt(i,n){i&1&&(a(0,"p"),o(1,"No hay rese\xF1a para este turno."),e())}var F=class i{constructor(n,t){this.dialogRef=n;this.data=t}static \u0275fac=function(t){return new(t||i)(R(ot),R(rt))};static \u0275cmp=v({type:i,selectors:[["app-dialogo-resena-turno"]],decls:9,vars:2,consts:[["sinResena",""],["mat-dialog-title",""],[4,"ngIf","ngIfElse"],["align","end"],["mat-button","","mat-dialog-close",""]],template:function(t,c){if(t&1&&(a(0,"h2",1),o(1,"Rese\xF1a de la consulta"),e(),a(2,"mat-dialog-content"),m(3,Pt,2,1,"p",2)(4,Mt,2,0,"ng-template",null,0,Y),e(),a(6,"mat-dialog-actions",3)(7,"button",4),o(8,"Cerrar"),e()()),t&2){let l=L(5);r(3),s("ngIf",c.data.resena)("ngIfElse",l)}},dependencies:[E,S,mt,st,lt,pt,dt,k,I],encapsulation:2})};function ht(i,n){i&1&&(a(0,"div"),o(1,"Cargando..."),e())}function Ot(i,n){i&1&&(a(0,"div"),o(1,"No has atendido pacientes a\xFAn."),e())}function vt(i,n){if(i&1){let t=w();a(0,"mat-card",6)(1,"div",7),$(2,"img",8),a(3,"div",9)(4,"h3"),o(5),g(6,"capitalize"),g(7,"capitalize"),e(),a(8,"button",10),M("click",function(){let l=C(t).$implicit,p=d(2);return P(p.toggleFavorito(l))}),a(9,"mat-icon"),o(10),e()()()(),a(11,"button",11),M("click",function(){let l=C(t).$implicit,p=d(2);return P(p.seleccionarPaciente(l))}),o(12,"Ver detalles"),e()()}if(i&2){let t=n.$implicit,c=d(2);N("selected",(c.pacienteSeleccionado==null?null:c.pacienteSeleccionado.uid)===t.uid),r(2),s("src",t.imagen1||"assets/paciente.jpg",U),r(3),V("",u(6,6,t.nombre)," ",u(7,8,t.apellido)),r(5),f(t.favorito?"favorite":"favorite_border")}}function wt(i,n){if(i&1&&(a(0,"div",4),m(1,vt,13,10,"mat-card",5),e()),i&2){let t=d();r(),s("ngForOf",t.pacientes)}}function yt(i,n){i&1&&(a(0,"div",17)(1,"mat-icon"),o(2,"event_busy"),e(),a(3,"p"),o(4,"No hay turnos registrados para este paciente"),e()())}function St(i,n){if(i&1){let t=w();a(0,"button",41),M("click",function(){C(t);let l=d().$implicit,p=d(3);return P(p.verResena(l))}),a(1,"mat-icon"),o(2,"visibility"),e(),o(3," Ver Rese\xF1a "),e()}}function Et(i,n){i&1&&(a(0,"span",42)(1,"mat-icon"),o(2,"remove"),e(),o(3," Sin rese\xF1a "),e())}function It(i,n){if(i&1){let t=w();a(0,"button",43),M("click",function(){C(t);let l=d().$implicit,p=d(3);return P(p.verHistorialClinicoTurno(l))}),a(1,"mat-icon"),o(2,"description"),e(),o(3," Ver Historia "),e()}}function kt(i,n){i&1&&(a(0,"span",42)(1,"mat-icon"),o(2,"remove"),e(),o(3," Sin historia "),e())}function Tt(i,n){if(i&1&&(a(0,"tr",26)(1,"td",27)(2,"div",28)(3,"span",29),o(4),g(5,"date"),e(),a(6,"span",30),o(7),g(8,"date"),e()()(),a(9,"td",31)(10,"div",32),o(11),e()(),a(12,"td",33)(13,"div",34)(14,"mat-icon",35),o(15),e(),a(16,"span"),o(17),g(18,"titlecase"),e()()(),a(19,"td",36),m(20,St,4,0,"button",37)(21,Et,4,0,"span",38),e(),a(22,"td",39),m(23,It,4,0,"button",40)(24,kt,4,0,"span",38),e()()),i&2){let t=n.$implicit,c=n.index,l=d(3);N("row-even",c%2===0)("row-odd",c%2===1),r(4),f(B(5,14,t.fecha,"dd/MM/yyyy")),r(3),y("",B(8,17,t.fecha,"HH:mm"),"hs"),r(4),y(" ",t.especialidad," "),r(2),s("ngClass","estado-"+t.estado),r(2),f(l.getEstadoIcon(t.estado)),r(2),f(u(18,20,t.estado)),r(3),s("ngIf",t.resena),r(),s("ngIf",!t.resena),r(2),s("ngIf",t.historiaClinicaId),r(),s("ngIf",!t.historiaClinicaId)}}function At(i,n){if(i&1&&(a(0,"div",18)(1,"table",19)(2,"thead")(3,"tr")(4,"th",20)(5,"mat-icon"),o(6,"schedule"),e(),o(7," Fecha & Hora "),e(),a(8,"th",21)(9,"mat-icon"),o(10,"medical_services"),e(),o(11," Especialidad "),e(),a(12,"th",22)(13,"mat-icon"),o(14,"info"),e(),o(15," Estado "),e(),a(16,"th",23)(17,"mat-icon"),o(18,"rate_review"),e(),o(19," Rese\xF1a "),e(),a(20,"th",24)(21,"mat-icon"),o(22,"assignment"),e(),o(23," Historia Cl\xEDnica "),e()()(),a(24,"tbody"),m(25,Tt,25,22,"tr",25),e()()()),i&2){let t=d(2);r(25),s("ngForOf",t.turnosPacienteSeleccionado)}}function Dt(i,n){if(i&1&&(a(0,"div",12)(1,"div",13)(2,"h3"),o(3),g(4,"capitalize"),g(5,"capitalize"),e(),a(6,"p",14),o(7),e()(),m(8,yt,5,0,"div",15)(9,At,26,1,"div",16),e()),i&2){let t=d();r(3),V("Historial de Turnos - ",u(4,5,t.pacienteSeleccionado.nombre)," ",u(5,7,t.pacienteSeleccionado.apellido)),r(4),y("Total: ",t.turnosPacienteSeleccionado.length," turno(s)"),r(),s("ngIf",t.turnosPacienteSeleccionado.length===0),r(),s("ngIf",t.turnosPacienteSeleccionado.length>0)}}var _t=class i{firestore=O(Z);authService=O(nt);dialog=O(ct);pacientes=[];pacienteSeleccionado=null;turnosPacienteSeleccionado=[];cargando=!0;ngOnInit(){return x(this,null,function*(){this.cargando=!0;let n=this.authService.userSignal();if(!n)return;let t=T(this.firestore,"turnos"),c=H(t,D("especialistaUid","==",n.uid)),p=(yield A(c)).docs.map(_=>_.data()).filter(_=>["realizado","finalizado"].includes(_.estado)),h=Array.from(new Set(p.map(_=>_.pacienteUid)));if(h.length){let _=T(this.firestore,"usuarios"),ft=yield A(_);this.pacientes=ft.docs.filter(b=>b.data().rol==="paciente"&&h.includes(b.id)).map(b=>j({uid:b.id},b.data()))}this.cargando=!1})}seleccionarPaciente(n){return x(this,null,function*(){this.pacienteSeleccionado=n;let t=this.authService.userSignal();if(!t)return;let c=T(this.firestore,"turnos"),l=H(c,D("pacienteUid","==",n.uid),D("especialistaUid","==",t.uid)),p=yield A(l);this.turnosPacienteSeleccionado=p.docs.map(h=>h.data())})}toggleFavorito(n){return x(this,null,function*(){n.favorito=!n.favorito})}verResena(n){this.dialog.open(F,{data:{resena:n.resena}})}verHistorialClinicoTurno(n){return x(this,null,function*(){if(!n.historiaClinicaId){this.dialog.open(z,{data:{paciente:{nombre:n.pacienteNombre,apellido:n.pacienteApellido},soloLectura:!0}});return}let t=tt(this.firestore,"historias-clinicas",n.historiaClinicaId),c=yield et(t);if(!c.exists()){this.dialog.open(z,{data:{paciente:{nombre:n.pacienteNombre,apellido:n.pacienteApellido},soloLectura:!0}});return}let l=c.data();this.dialog.open(z,{data:{paciente:{nombre:n.pacienteNombre,apellido:n.pacienteApellido},historia:l,soloLectura:!0}})})}getEstadoIcon(n){switch(n?.toLowerCase()){case"realizado":case"finalizado":return"check_circle";case"pendiente":return"schedule";case"cancelado":return"cancel";case"rechazado":return"block";default:return"help_outline"}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=v({type:i,selectors:[["app-pacientes-atendidos"]],decls:7,vars:4,consts:[[1,"pacientes-atendidos-container"],[4,"ngIf"],["class","pacientes-lista",4,"ngIf"],["class","turnos-section",4,"ngIf"],[1,"pacientes-lista"],["class","paciente-card",3,"selected",4,"ngFor","ngForOf"],[1,"paciente-card"],[1,"paciente-header"],["alt","Foto de perfil",1,"paciente-avatar",3,"src"],[1,"paciente-nombre"],["mat-icon-button","","color","warn",3,"click"],["mat-stroked-button","","color","primary",3,"click"],[1,"turnos-section"],[1,"turnos-header"],[1,"turnos-count"],["class","no-turnos",4,"ngIf"],["class","turnos-table-container",4,"ngIf"],[1,"no-turnos"],[1,"turnos-table-container"],[1,"turnos-table"],[1,"fecha-col"],[1,"especialidad-col"],[1,"estado-col"],[1,"resena-col"],[1,"historial-col"],["class","turno-row",3,"row-even","row-odd",4,"ngFor","ngForOf"],[1,"turno-row"],[1,"fecha-cell"],[1,"fecha-info"],[1,"fecha-day"],[1,"fecha-time"],[1,"especialidad-cell"],[1,"especialidad-badge"],[1,"estado-cell"],[1,"estado-badge",3,"ngClass"],[1,"estado-icon"],[1,"resena-cell"],["mat-raised-button","","color","accent","class","action-button resena-button",3,"click",4,"ngIf"],["class","no-data",4,"ngIf"],[1,"historial-cell"],["mat-raised-button","","color","primary","class","action-button historial-button",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",1,"action-button","resena-button",3,"click"],[1,"no-data"],["mat-raised-button","","color","primary",1,"action-button","historial-button",3,"click"]],template:function(t,c){t&1&&(a(0,"div",0)(1,"h2"),o(2,"Pacientes Atendidos"),e(),m(3,ht,2,0,"div",1)(4,Ot,2,0,"div",1)(5,wt,2,1,"div",2)(6,Dt,10,9,"div",3),e()),t&2&&(r(3),s("ngIf",c.cargando),r(),s("ngIf",!c.cargando&&c.pacientes.length===0),r(),s("ngIf",c.pacientes.length),r(),s("ngIf",c.pacienteSeleccionado))},dependencies:[E,q,G,S,J,K,W,Q,k,I,X,at,it,gt],styles:[".pacientes-atendidos-container[_ngcontent-%COMP%]{background:var(--bg-color);min-height:100vh;padding:2rem;margin:0;color:var(--text-color)}.pacientes-atendidos-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:var(--text-color)}.pacientes-atendidos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#1976d2;font-weight:600}table[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;box-shadow:0 4px 16px var(--shadow);background:var(--card-bg)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#42a5f5);color:#fff;font-weight:600;padding:1rem;text-align:left;font-size:1rem}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid rgba(66,165,245,.2)}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:none}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#42a5f50d}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#42a5f51a;transition:background .2s ease}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#42a5f5,#64b5f6);color:#fff;border:none;border-radius:8px;padding:8px 16px;font-weight:600;cursor:pointer;transition:all .3s ease}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1976d2,#42a5f5);transform:translateY(-1px);box-shadow:0 4px 12px #42a5f54d}.pacientes-lista[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem;margin-top:1.5rem;justify-content:center}.paciente-card[_ngcontent-%COMP%]{background:var(--card-bg);box-shadow:0 4px 16px var(--shadow);border-radius:18px;padding:1.5rem;display:flex;flex-direction:column;justify-content:space-between;color:var(--text-color);transition:all .3s ease;min-width:320px;max-width:420px;border:1px solid rgba(66,165,245,.1)}.paciente-card[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 8px 24px #42a5f533}.paciente-card.selected[_ngcontent-%COMP%]{border-color:#42a5f5;box-shadow:0 8px 24px #42a5f54d}.paciente-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.25rem;color:var(--text-color)}.paciente-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.3rem 0}.paciente-card[_ngcontent-%COMP%]   button[mat-stroked-button][_ngcontent-%COMP%]{background:linear-gradient(135deg,#42a5f5,#64b5f6);color:#fff;border:1px solid #42a5f5;border-radius:8px;padding:10px 20px;font-weight:600;transition:all .3s ease;margin-top:1rem}.paciente-card[_ngcontent-%COMP%]   button[mat-stroked-button][_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1976d2,#42a5f5);transform:translateY(-1px);box-shadow:0 4px 12px #42a5f54d;border-color:#1976d2}.paciente-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1rem}.paciente-avatar[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;object-fit:cover;border:3px solid rgba(66,165,245,.3);transition:border-color .3s ease}.paciente-avatar[_ngcontent-%COMP%]:hover{border-color:#42a5f5}.paciente-nombre[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex:1}.paciente-nombre[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#1976d2}.paciente-nombre[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]{margin-left:.5rem;border-radius:50%;transition:all .3s ease}.paciente-nombre[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]:hover{background:#f443361a;transform:scale(1.1)}.paciente-nombre[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}.cargando[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#42a5f5;font-size:1.1rem}.appointments-table[_ngcontent-%COMP%]{margin-top:20px;background:linear-gradient(145deg,#f8f9ff,#fff);border-radius:12px;box-shadow:0 4px 20px #1976d21a;overflow:hidden}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#42a5f5);color:#fff;padding:20px;display:grid;grid-template-columns:1fr 120px 150px 120px 120px 180px;gap:16px;align-items:center;font-weight:600;font-size:14px;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 2px 8px #1976d233}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;opacity:.9}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 120px 150px 120px 120px 180px;gap:16px;padding:20px;border-bottom:1px solid rgba(25,118,210,.1);align-items:center;transition:all .3s ease;background:#fff}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#f3f7ff,#e8f2ff);transform:translateY(-1px);box-shadow:0 4px 12px #1976d226}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:last-child{border-bottom:none;border-bottom-left-radius:12px;border-bottom-right-radius:12px}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%]   .specialty[_ngcontent-%COMP%]{font-weight:600;color:#1976d2;font-size:15px}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#666;font-size:13px}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:20px}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.realizado[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.finalizado[_ngcontent-%COMP%]{color:#4caf50}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.pendiente[_ngcontent-%COMP%]{color:#ff9800}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.cancelado[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.rechazado[_ngcontent-%COMP%]{color:#f44336}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-weight:500;text-transform:capitalize}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{min-width:36px;width:36px;height:36px;border-radius:8px;font-size:14px;font-weight:500;transition:all .3s ease;box-shadow:0 2px 6px #0000001a}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.history-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#42a5f5);color:#fff}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.history-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1565c0,#1e88e5);transform:translateY(-2px);box-shadow:0 4px 12px #1976d266}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.review-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#66bb6a);color:#fff}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.review-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#388e3c,#4caf50);transform:translateY(-2px);box-shadow:0 4px 12px #4caf5066}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}@media (max-width: 768px){.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:none}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;padding:16px}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{transform:none}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]{align-self:flex-start}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{align-self:flex-start;margin-top:12px}}"]})};export{_t as PacientesAtendidos};
