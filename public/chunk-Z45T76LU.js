import{a as nt}from"./chunk-WCD3Q4W7.js";import{a as k}from"./chunk-RYFVWRO2.js";import"./chunk-G4N2NV2X.js";import{a as j,g as L}from"./chunk-YW64IYPY.js";import{a as it}from"./chunk-OGFC4C5S.js";import{e as Z,f as tt,i as et}from"./chunk-ULQMERRE.js";import{D as q,E as G,F as J,Z as X}from"./chunk-VT4TCVZO.js";import{Ab as D,Eb as v,Gb as h,Hb as p,Ic as N,Jc as H,Kc as U,Nc as R,Oa as V,Oc as $,Pc as Y,Qa as c,Tb as z,Vb as i,Wb as u,Xb as w,Yb as y,Zd as K,_ as O,ab as B,ce as S,de as Q,ea as P,ec as g,ee as W,fa as M,fc as x,fe as E,gb as _,gc as A,ie as T,le as I,xb as s,yb as a,zb as e}from"./chunk-VNSJBZ2B.js";import{a as F,h as C}from"./chunk-FJYW2LMB.js";function ct(o,n){o&1&&(a(0,"div"),i(1,"Cargando..."),e())}function rt(o,n){o&1&&(a(0,"div"),i(1,"No has atendido pacientes a\xFAn."),e())}function st(o,n){if(o&1){let t=v();a(0,"mat-card",6),h("click",function(){let l=P(t).$implicit,d=p(2);return M(d.seleccionarPaciente(l))}),a(1,"div",7)(2,"div",8),D(3,"img",9),a(4,"button",10),h("click",function(l){let d=P(t).$implicit,f=p(2);return M(f.toggleFavorito(d,l))}),a(5,"mat-icon"),i(6),e()()(),a(7,"div",11)(8,"h3"),i(9),g(10,"capitalize"),g(11,"capitalize"),e(),a(12,"p",12),i(13),e(),a(14,"div",13)(15,"span",14)(16,"mat-icon"),i(17,"event"),e(),i(18),e()()()()()}if(o&2){let t=n.$implicit,r=p(2);z("selected",(r.pacienteSeleccionado==null?null:r.pacienteSeleccionado.uid)===t.uid),c(3),s("src",t.imagen1||"assets/paciente.jpg",V),c(3),u(t.favorito?"favorite":"favorite_border"),c(3),y("",x(10,9,t.nombre)," ",x(11,11,t.apellido)),c(4),u(t.email),c(5),y(" ",r.getConsultasCount(t.uid)," consulta",r.getConsultasCount(t.uid)!==1?"s":""," ")}}function lt(o,n){if(o&1&&(a(0,"div",4),_(1,st,19,13,"mat-card",5),e()),o&2){let t=p();c(),s("ngForOf",t.pacientes)}}function dt(o,n){o&1&&(a(0,"div",20)(1,"mat-icon"),i(2,"event_busy"),e(),a(3,"p"),i(4,"No hay turnos registrados para este paciente"),e()())}function pt(o,n){if(o&1){let t=v();a(0,"button",44),h("click",function(){P(t);let l=p().$implicit,d=p(3);return M(d.verResena(l))}),a(1,"mat-icon"),i(2,"visibility"),e(),i(3," Ver Rese\xF1a "),e()}}function gt(o,n){o&1&&(a(0,"span",45)(1,"mat-icon"),i(2,"remove"),e(),i(3," Sin rese\xF1a "),e())}function mt(o,n){if(o&1){let t=v();a(0,"button",46),h("click",function(){P(t);let l=p().$implicit,d=p(3);return M(d.verHistorialClinicoTurno(l))}),a(1,"mat-icon"),i(2,"description"),e(),i(3," Ver Historia "),e()}}function _t(o,n){o&1&&(a(0,"span",45)(1,"mat-icon"),i(2,"remove"),e(),i(3," Sin historia "),e())}function ft(o,n){if(o&1&&(a(0,"tr",29)(1,"td",30)(2,"div",31)(3,"span",32),i(4),g(5,"date"),e(),a(6,"span",33),i(7),g(8,"date"),e()()(),a(9,"td",34)(10,"div",35),i(11),e()(),a(12,"td",36)(13,"div",37)(14,"mat-icon",38),i(15),e(),a(16,"span"),i(17),g(18,"titlecase"),e()()(),a(19,"td",39),_(20,pt,4,0,"button",40)(21,gt,4,0,"span",41),e(),a(22,"td",42),_(23,mt,4,0,"button",43)(24,_t,4,0,"span",41),e()()),o&2){let t=n.$implicit,r=n.index,l=p(3);z("row-even",r%2===0)("row-odd",r%2===1),c(4),u(A(5,14,t.fecha,"dd/MM/yyyy")),c(3),w("",A(8,17,t.fecha,"HH:mm"),"hs"),c(4),w(" ",t.especialidad," "),c(2),s("ngClass","estado-"+t.estado),c(2),u(l.getEstadoIcon(t.estado)),c(2),u(x(18,20,t.estado)),c(3),s("ngIf",t.resena),c(),s("ngIf",!t.resena),c(2),s("ngIf",t.historiaClinicaId),c(),s("ngIf",!t.historiaClinicaId)}}function ut(o,n){if(o&1&&(a(0,"div",21)(1,"table",22)(2,"thead")(3,"tr")(4,"th",23)(5,"mat-icon"),i(6,"schedule"),e(),i(7," Fecha & Hora "),e(),a(8,"th",24)(9,"mat-icon"),i(10,"medical_services"),e(),i(11," Especialidad "),e(),a(12,"th",25)(13,"mat-icon"),i(14,"info"),e(),i(15," Estado "),e(),a(16,"th",26)(17,"mat-icon"),i(18,"rate_review"),e(),i(19," Rese\xF1a "),e(),a(20,"th",27)(21,"mat-icon"),i(22,"assignment"),e(),i(23," Historia Cl\xEDnica "),e()()(),a(24,"tbody"),_(25,ft,25,22,"tr",28),e()()()),o&2){let t=p(2);c(25),s("ngForOf",t.turnosPacienteSeleccionado)}}function xt(o,n){if(o&1&&(a(0,"div",15)(1,"div",16)(2,"h3"),i(3),g(4,"capitalize"),g(5,"capitalize"),e(),a(6,"p",17),i(7),e()(),_(8,dt,5,0,"div",18)(9,ut,26,1,"div",19),e()),o&2){let t=p();c(3),y("Historial de Turnos - ",x(4,5,t.pacienteSeleccionado.nombre)," ",x(5,7,t.pacienteSeleccionado.apellido)),c(4),w("Total: ",t.turnosPacienteSeleccionado.length," turno(s)"),c(),s("ngIf",t.turnosPacienteSeleccionado.length===0),c(),s("ngIf",t.turnosPacienteSeleccionado.length>0)}}var at=class o{firestore=O(K);authService=O(X);dialog=O(et);pacientes=[];pacienteSeleccionado=null;turnosPacienteSeleccionado=[];todosTurnos=[];cargando=!0;ngOnInit(){return C(this,null,function*(){this.cargando=!0;let n=this.authService.userSignal();if(!n)return;let t=S(this.firestore,"turnos"),r=T(t,I("especialistaUid","==",n.uid)),d=(yield E(r)).docs.map(m=>m.data()).filter(m=>["realizado","finalizado"].includes(m.estado));this.todosTurnos=d;let f=Array.from(new Set(d.map(m=>m.pacienteUid)));if(f.length){let m=S(this.firestore,"usuarios"),ot=yield E(m);this.pacientes=ot.docs.filter(b=>b.data().rol==="paciente"&&f.includes(b.id)).map(b=>F({uid:b.id},b.data()))}this.cargando=!1})}seleccionarPaciente(n){return C(this,null,function*(){this.pacienteSeleccionado=n;let t=this.authService.userSignal();if(!t)return;let r=S(this.firestore,"turnos"),l=T(r,I("pacienteUid","==",n.uid),I("especialistaUid","==",t.uid)),d=yield E(l);this.turnosPacienteSeleccionado=d.docs.map(f=>f.data())})}toggleFavorito(n,t){return C(this,null,function*(){t.stopPropagation(),n.favorito=!n.favorito})}getConsultasCount(n){return this.todosTurnos.filter(t=>t.pacienteUid===n&&["realizado","finalizado"].includes(t.estado)).length}verResena(n){this.dialog.open(nt,{data:{resena:n.resena}})}verHistorialClinicoTurno(n){return C(this,null,function*(){if(!n.historiaClinicaId){this.dialog.open(k,{data:{paciente:{nombre:n.pacienteNombre,apellido:n.pacienteApellido},soloLectura:!0}});return}let t=Q(this.firestore,"historias-clinicas",n.historiaClinicaId),r=yield W(t);if(!r.exists()){this.dialog.open(k,{data:{paciente:{nombre:n.pacienteNombre,apellido:n.pacienteApellido},soloLectura:!0}});return}let l=r.data();this.dialog.open(k,{data:{paciente:{nombre:n.pacienteNombre,apellido:n.pacienteApellido},historia:l,soloLectura:!0}})})}getEstadoIcon(n){switch(n?.toLowerCase()){case"realizado":case"finalizado":return"check_circle";case"pendiente":return"schedule";case"cancelado":return"cancel";case"rechazado":return"block";default:return"help_outline"}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=B({type:o,selectors:[["app-pacientes-atendidos"]],decls:7,vars:4,consts:[[1,"pacientes-atendidos-container"],[4,"ngIf"],["class","pacientes-lista",4,"ngIf"],["class","turnos-section",4,"ngIf"],[1,"pacientes-lista"],["class","paciente-card",3,"selected","click",4,"ngFor","ngForOf"],[1,"paciente-card",3,"click"],[1,"paciente-header"],[1,"avatar-container"],["alt","Foto de perfil",1,"paciente-avatar",3,"src"],["mat-fab","","color","accent",1,"favorite-button",3,"click"],[1,"paciente-info"],[1,"paciente-email"],[1,"paciente-stats"],[1,"consultas-count"],[1,"turnos-section"],[1,"turnos-header"],[1,"turnos-count"],["class","no-turnos",4,"ngIf"],["class","turnos-table-container",4,"ngIf"],[1,"no-turnos"],[1,"turnos-table-container"],[1,"turnos-table"],[1,"fecha-col"],[1,"especialidad-col"],[1,"estado-col"],[1,"resena-col"],[1,"historial-col"],["class","turno-row",3,"row-even","row-odd",4,"ngFor","ngForOf"],[1,"turno-row"],[1,"fecha-cell"],[1,"fecha-info"],[1,"fecha-day"],[1,"fecha-time"],[1,"especialidad-cell"],[1,"especialidad-badge"],[1,"estado-cell"],[1,"estado-badge",3,"ngClass"],[1,"estado-icon"],[1,"resena-cell"],["mat-raised-button","","color","accent","class","action-button resena-button",3,"click",4,"ngIf"],["class","no-data",4,"ngIf"],[1,"historial-cell"],["mat-raised-button","","color","primary","class","action-button historial-button",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",1,"action-button","resena-button",3,"click"],[1,"no-data"],["mat-raised-button","","color","primary",1,"action-button","historial-button",3,"click"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"h2"),i(2,"Pacientes Atendidos"),e(),_(3,ct,2,0,"div",1)(4,rt,2,0,"div",1)(5,lt,2,1,"div",2)(6,xt,10,9,"div",3),e()),t&2&&(c(3),s("ngIf",r.cargando),c(),s("ngIf",!r.cargando&&r.pacientes.length===0),c(),s("ngIf",r.pacientes.length),c(),s("ngIf",r.pacienteSeleccionado))},dependencies:[Y,N,H,U,R,$,L,j,J,q,G,tt,Z,it],styles:[".pacientes-atendidos-container[_ngcontent-%COMP%]{background:var(--bg-color);min-height:100vh;padding:2rem;margin:0;color:var(--text-color)}.pacientes-atendidos-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:var(--text-color)}.pacientes-atendidos-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:#1976d2;font-weight:600}table[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;border-collapse:separate;border-spacing:0;border-radius:12px;overflow:hidden;box-shadow:0 4px 16px var(--shadow);background:var(--card-bg)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#42a5f5);color:#fff;font-weight:600;padding:1rem;text-align:left;font-size:1rem}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid rgba(66,165,245,.2)}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:none}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#42a5f50d}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#42a5f51a;transition:background .2s ease}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#42a5f5,#64b5f6);color:#fff;border:none;border-radius:8px;padding:8px 16px;font-weight:600;cursor:pointer;transition:all .3s ease}table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1976d2,#42a5f5);transform:translateY(-1px);box-shadow:0 4px 12px #42a5f54d}.pacientes-lista[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem;margin-top:1.5rem;justify-content:center}.paciente-card[_ngcontent-%COMP%]{background:var(--card-bg);box-shadow:0 4px 16px var(--shadow);border-radius:18px;padding:1.5rem;color:var(--text-color);transition:all .3s cubic-bezier(.4,0,.2,1);min-width:320px;max-width:420px;border:2px solid transparent;cursor:pointer;position:relative;overflow:visible}.paciente-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 12px 32px var(--shadow-dark);border-color:#1976d2}.paciente-card.selected[_ngcontent-%COMP%]{border-color:#1976d2;background:linear-gradient(135deg,#1976d21a,#42a5f50d)}.paciente-card.selected[_ngcontent-%COMP%]   .paciente-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#1976d2}.paciente-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.paciente-header[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]{position:relative;flex-shrink:0}.paciente-header[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .favorite-button[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;width:32px;height:32px;min-height:32px;background:linear-gradient(135deg,#ff4081,#f50057);box-shadow:0 2px 8px #f500574d}.paciente-header[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .favorite-button[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 4px 12px #f5005780}.paciente-header[_ngcontent-%COMP%]   .avatar-container[_ngcontent-%COMP%]   .favorite-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px;color:#fff}.paciente-header[_ngcontent-%COMP%]   .paciente-info[_ngcontent-%COMP%]{flex:1}.paciente-header[_ngcontent-%COMP%]   .paciente-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.4rem;font-weight:600;color:var(--text-color);transition:color .3s ease}.paciente-header[_ngcontent-%COMP%]   .paciente-info[_ngcontent-%COMP%]   .paciente-email[_ngcontent-%COMP%]{margin:0 0 .75rem;color:#666;font-size:.9rem}.paciente-header[_ngcontent-%COMP%]   .paciente-info[_ngcontent-%COMP%]   .paciente-stats[_ngcontent-%COMP%]   .consultas-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#1976d2;font-weight:500;font-size:.9rem}.paciente-header[_ngcontent-%COMP%]   .paciente-info[_ngcontent-%COMP%]   .paciente-stats[_ngcontent-%COMP%]   .consultas-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.paciente-avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid #f0f0f0;transition:all .3s ease}.paciente-avatar[_ngcontent-%COMP%]:hover{border-color:#42a5f5}.paciente-nombre[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex:1}.paciente-nombre[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#1976d2}.paciente-nombre[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]{margin-left:.5rem;border-radius:50%;transition:all .3s ease}.paciente-nombre[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]:hover{background:#f443361a;transform:scale(1.1)}.paciente-nombre[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}.cargando[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#42a5f5;font-size:1.1rem}.appointments-table[_ngcontent-%COMP%]{margin-top:20px;background:linear-gradient(145deg,#f8f9ff,#fff);border-radius:12px;box-shadow:0 4px 20px #1976d21a;overflow:hidden}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#42a5f5);color:#fff;padding:20px;display:grid;grid-template-columns:1fr 120px 150px 120px 120px 180px;gap:16px;align-items:center;font-weight:600;font-size:14px;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 2px 8px #1976d233}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]   .header-cell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;opacity:.9}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 120px 150px 120px 120px 180px;gap:16px;padding:20px;border-bottom:1px solid rgba(25,118,210,.1);align-items:center;transition:all .3s ease;background:#fff}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background:linear-gradient(145deg,#f3f7ff,#e8f2ff);transform:translateY(-1px);box-shadow:0 4px 12px #1976d226}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:last-child{border-bottom:none;border-bottom-left-radius:12px;border-bottom-right-radius:12px}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%]   .specialty[_ngcontent-%COMP%]{font-weight:600;color:#1976d2;font-size:15px}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:#666;font-size:13px}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:20px}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.realizado[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.finalizado[_ngcontent-%COMP%]{color:#4caf50}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.pendiente[_ngcontent-%COMP%]{color:#ff9800}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.cancelado[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-icon.rechazado[_ngcontent-%COMP%]{color:#f44336}.appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{font-weight:500;text-transform:capitalize}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{min-width:36px;width:36px;height:36px;border-radius:8px;font-size:14px;font-weight:500;transition:all .3s ease;box-shadow:0 2px 6px #0000001a}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.history-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#42a5f5);color:#fff}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.history-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#1565c0,#1e88e5);transform:translateY(-2px);box-shadow:0 4px 12px #1976d266}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.review-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#66bb6a);color:#fff}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn.review-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#388e3c,#4caf50);transform:translateY(-2px);box-shadow:0 4px 12px #4caf5066}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px}@media (max-width: 768px){.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.appointments-table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{display:none}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:stretch;padding:16px}.appointments-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{transform:none}.appointments-table[_ngcontent-%COMP%]   .appointment-info[_ngcontent-%COMP%], .appointments-table[_ngcontent-%COMP%]   .status-cell[_ngcontent-%COMP%]{align-self:flex-start}.appointments-table[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{align-self:flex-start;margin-top:12px}}"]})};export{at as PacientesAtendidos};
